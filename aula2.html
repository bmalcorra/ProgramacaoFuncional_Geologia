<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Intensivão de programação funcional em R aplicado à Geologia</title>
    <meta charset="utf-8" />
    <meta name="author" content="Bárbara Malcorra, Gabriel Bertolini" />
    <meta name="date" content="2021-07-19" />
    <script src="libs/header-attrs-2.9/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Intensivão de programação funcional em R aplicado à Geologia
## ⚒<br/>Aula 2 - programação funcional
### Bárbara Malcorra, Gabriel Bertolini
### UFRGS
### 2021-07-19

---








# Tidyverse


```r
#install.packages("tidyverse")
library(tidyverse)
```

- Família de pacote recente


.pull-left[
&lt;img src="https://tidyverse.tidyverse.org/articles/tidyverse-logo.png" width="70%" style="display: block; margin: auto;" /&gt;

]

.pull-right[
&lt;img src="https://education.rstudio.com/blog/2020/07/teaching-the-tidyverse-in-2020-part-1-getting-started/img/tidyverse-packages.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---
# Pipe %&gt;%

- Analisa o código do lado esquerdo e passa o resultado como o primeiro argumento do código do lado direito

- Atalho Ctrl + Shift + M

&lt;img src="https://magrittr.tidyverse.org/logo.png" width="30%" style="display: block; margin: auto;" /&gt;

---
# Comandos lógicos

**&lt;** menor que  
**&gt;** maior que  
**&lt;=** menor igual a  
**&gt;=** maior igual a  
**==** igual a  
**&amp;** e  
**|** ou  
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
**!** diferente de 
**%in%** faz parte de um grupo  
**is.na()** é NA  

---
# Lembrete

- Boa parte da programação está em:
  - 1) consertar erros de sintaxe do seu código  
  - 2) pesquisar por soluções no Google (você vai cair no StackOverflow)  
=======
**!** diferente de  
  
  
- Boa parte da programação está em:  
 -- 1) consertar erros de sintaxe do seu código  
 -- 2) pesquisar por soluções no Google (você vai cair no StackOverflow)  
&gt;&gt;&gt;&gt;&gt;&gt;&gt; bbc25d19e028bc86eb29838526a6f5380aa22bed

---
# Pacotes

Compilado de funções especiais  
Nos ajudam a desenvolver códigos mais robustos, além de facilitarem resoluções de problemas  


```r
#install.packages("tidyverse")
library(tidyverse)
??tidyverse
```

---
# Estabelecendo um diretório de trabalho


```r
setwd("C:/Users/barba/Desktop/ProgramacaoFuncional_Geologia/ProgramacaoFuncional_Geologia/")

getwd()
```

```
[1] "C:/Users/barba/Desktop/ProgramacaoFuncional_Geologia/ProgramacaoFuncional_Geologia"
```

---
# Importando os dados

- de um arquivo .csv


```r
dados &lt;- read.csv("geoquim_granite.csv", header = TRUE, sep = ";") %&gt;% 
  as_tibble()
#espécie de dataframe com particularidades
#mostra o tipo de variável

dados
```

```
# A tibble: 3,050 x 116
   X     Tectonic_setting Location_notes    Pluton  Colour Symbol Size_rel  Size
   &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;             &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt;
 1 CR03  OROGENIC BELT    ////////Peninsul~ Cape P~ brown4     16      1.6  1.28
 2 BB202 OROGENIC BELT    ////////Peninsul~ Cape P~ brown4     16      1.6  1.28
 3 CB02  OROGENIC BELT    ////////Peninsul~ Cape P~ brown4     16      1.6  1.28
 4 HB02  OROGENIC BELT    ////////Peninsul~ Cape P~ brown4     16      1.6  1.28
 5 CR01  OROGENIC BELT    ////////Peninsul~ Cape P~ brown4     16      1.6  1.28
 6 LL01  OROGENIC BELT    ////////Peninsul~ Cape P~ brown4     16      1.6  1.28
 7 MP21  OROGENIC BELT    ////////Peninsul~ Cape P~ brown4     16      1.6  1.28
 8 OK07  OROGENIC BELT    ////////Peninsul~ Cape P~ brown4     16      1.6  1.28
 9 LG05  OROGENIC BELT    ////////Langebaa~ Cape P~ brown4     16      1.6  1.28
10 BB201 OROGENIC BELT    ////////Peninsul~ Cape P~ brown4     16      1.6  1.28
# ... with 3,040 more rows, and 108 more variables: SubGroup &lt;chr&gt;,
#   Group &lt;chr&gt;, DebonPQ &lt;chr&gt;, TASMiddlemostPlut &lt;chr&gt;, Villaseca &lt;chr&gt;,
#   QANOR &lt;chr&gt;, LaRoche &lt;chr&gt;, Geol_unit_notes &lt;chr&gt;, Rock_type_notes &lt;chr&gt;,
#   Ref &lt;chr&gt;, Age &lt;chr&gt;, Latitude &lt;dbl&gt;, Longitude &lt;dbl&gt;, SiO2 &lt;dbl&gt;,
#   TiO2 &lt;dbl&gt;, Al2O3 &lt;dbl&gt;, FeOt &lt;dbl&gt;, MnO &lt;dbl&gt;, MgO &lt;dbl&gt;, CaO &lt;dbl&gt;,
#   K2O &lt;dbl&gt;, Na2O &lt;dbl&gt;, P2O5 &lt;chr&gt;, H2O &lt;dbl&gt;, H2Ot &lt;dbl&gt;, H2O.MINUS &lt;dbl&gt;,
#   LOI &lt;chr&gt;, Li &lt;dbl&gt;, Be &lt;dbl&gt;, B &lt;dbl&gt;, Sc &lt;dbl&gt;, V &lt;chr&gt;, Cr &lt;dbl&gt;,
#   Ni &lt;dbl&gt;, Cu &lt;dbl&gt;, Zn &lt;dbl&gt;, Rb &lt;dbl&gt;, Sr &lt;dbl&gt;, Y &lt;dbl&gt;, Zr &lt;dbl&gt;,
#   Nb &lt;dbl&gt;, Cs &lt;dbl&gt;, Ba &lt;dbl&gt;, La &lt;chr&gt;, Ce &lt;dbl&gt;, Pr &lt;chr&gt;, Nd &lt;chr&gt;,
#   Sm &lt;chr&gt;, Eu &lt;chr&gt;, Gd &lt;chr&gt;, Tb &lt;dbl&gt;, Dy &lt;dbl&gt;, Ho &lt;dbl&gt;, Er &lt;dbl&gt;,
#   Tm &lt;dbl&gt;, Yb &lt;dbl&gt;, Lu &lt;dbl&gt;, Hf &lt;dbl&gt;, Ta &lt;dbl&gt;, Pb &lt;dbl&gt;, Th &lt;chr&gt;,
#   U &lt;dbl&gt;, Co &lt;dbl&gt;, Mo &lt;chr&gt;, W &lt;dbl&gt;, Ga &lt;dbl&gt;, Ge &lt;dbl&gt;, As &lt;chr&gt;,
#   In &lt;dbl&gt;, Sn &lt;chr&gt;, Sb &lt;chr&gt;, Cd &lt;chr&gt;, Q &lt;dbl&gt;, C &lt;dbl&gt;, Or &lt;dbl&gt;,
#   Ab &lt;dbl&gt;, An &lt;dbl&gt;, Ne &lt;dbl&gt;, Ns &lt;dbl&gt;, Ks &lt;int&gt;, Di &lt;dbl&gt;, Wo &lt;dbl&gt;,
#   Hy &lt;dbl&gt;, Ol &lt;dbl&gt;, Il &lt;dbl&gt;, Tn &lt;dbl&gt;, Pf &lt;dbl&gt;, Ru &lt;dbl&gt;, Ap &lt;dbl&gt;,
#   Sum_CIPW &lt;dbl&gt;, Orthoclase &lt;dbl&gt;, Albite &lt;dbl&gt;, Anorthite &lt;dbl&gt;,
#   Quartz &lt;dbl&gt;, Apatite &lt;dbl&gt;, Ilmenite &lt;dbl&gt;, Biotite &lt;dbl&gt;,
#   Amphibole &lt;dbl&gt;, Corundum &lt;dbl&gt;, Rest &lt;dbl&gt;, ...
```

---
# Importando os dados

- de um arquivo excel


```r
#install.packages("readxl")
library(readxl)

dados.ex &lt;- read_excel("dados_santos2009.xlsx") %&gt;% 
  as_tibble()

dados.ex
```

```
# A tibble: 26 x 29
   Sample  Rock     `Distance from c~    Co    Ni    Cr     V    Sr    Rb     Ba
   &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;             &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 SUC I-~ Black s~ 2.3–2.7           19.2   6.47  16.1  23.2  33.5  1.1   49.8 
 2 SUC I-~ Black s~ 2.3–2.7            7.23  9.57  17.2  26.2 412.   1.81  25.0 
 3 SUC I ~ Limesto~ 2.1                6.65 10.8   16.3  23.2 604.   0.17 101.  
 4 SUC I ~ Limesto~ 2.04999999999999~  6.64 10.6   15.7  22.9 576.   0.18  72.6 
 5 SUC I ~ Limesto~ 2                  8.5  10.3   18.1  28.0 599.   1.89 139.  
 6 SUC I-~ Black s~ 0.6–1.5           10.7  12.5   24.0  37.1  77.6  8.48  43.2 
 7 SUC I-9 Stoliti~ 0.4                7.24 10.9   14.9  22.5 535.   0.1  106.  
 8 SUC I ~ Limesto~ 0.35–340           2.55  5.4   13.0  20.3  27.0  0.09   4.83
 9 SUC I-7 Black s~ 0.2–0.3           10.1   8.11  19.6  29.0  77.1  8.33  24.5 
10 SUC I-~ Black s~ 0.2–0.3            8.14  7.35  16.6  27.0  63.2 14.3   26.8 
# ... with 16 more rows, and 19 more variables: Pb &lt;dbl&gt;, Zr &lt;dbl&gt;, Yb &lt;dbl&gt;,
#   Nb &lt;dbl&gt;, Hf &lt;dbl&gt;, Th &lt;dbl&gt;, U &lt;dbl&gt;, La &lt;dbl&gt;, Ce &lt;dbl&gt;, Pr &lt;dbl&gt;,
#   Nd &lt;dbl&gt;, Sm &lt;dbl&gt;, Eu &lt;dbl&gt;, Gd &lt;dbl&gt;, Tb &lt;dbl&gt;, Dy &lt;dbl&gt;, Ho &lt;dbl&gt;,
#   Er &lt;dbl&gt;, Tm &lt;dbl&gt;
```

---
# Inspecionando os dados


```r
summary(dados.ex)
```

```
    Sample              Rock           Distance from contact (m)
 Length:26          Length:26          Length:26                
 Class :character   Class :character   Class :character         
 Mode  :character   Mode  :character   Mode  :character         
                                                                
                                                                
                                                                
       Co               Ni               Cr              V         
 Min.   : 2.550   Min.   : 5.400   Min.   :12.97   Min.   : 20.26  
 1st Qu.: 6.655   1st Qu.: 7.603   1st Qu.:14.82   1st Qu.: 23.24  
 Median : 8.040   Median : 9.260   Median :16.20   Median : 27.13  
 Mean   :11.382   Mean   :10.618   Mean   :19.19   Mean   : 54.58  
 3rd Qu.:10.805   3rd Qu.:10.770   3rd Qu.:19.46   3rd Qu.: 31.93  
 Max.   :36.230   Max.   :32.480   Max.   :50.67   Max.   :379.09  
       Sr               Rb                Ba               Pb       
 Min.   : 26.88   Min.   : 0.0900   Min.   :  4.83   Min.   :0.580  
 1st Qu.: 64.05   1st Qu.: 0.5825   1st Qu.: 21.94   1st Qu.:1.570  
 Median :149.51   Median : 1.4550   Median : 39.20   Median :2.470  
 Mean   :229.71   Mean   : 5.2661   Mean   : 77.99   Mean   :2.862  
 3rd Qu.:350.89   3rd Qu.: 8.1525   3rd Qu.: 84.97   3rd Qu.:3.760  
 Max.   :603.64   Max.   :40.7500   Max.   :507.86   Max.   :7.830  
       Zr               Yb              Nb               Hf        
 Min.   :  8.69   Min.   :0.130   Min.   : 0.650   Min.   :0.2700  
 1st Qu.: 10.76   1st Qu.:0.195   1st Qu.: 0.975   1st Qu.:0.3125  
 Median : 17.23   Median :0.305   Median : 1.090   Median :0.4450  
 Mean   : 35.33   Mean   :0.515   Mean   : 3.161   Mean   :0.8962  
 3rd Qu.: 24.78   3rd Qu.:0.590   3rd Qu.: 2.703   3rd Qu.:0.6675  
 Max.   :279.60   Max.   :2.930   Max.   :26.910   Max.   :6.5300  
       Th               U                La               Ce       
 Min.   :0.0400   Min.   :0.0200   Min.   : 0.480   Min.   : 1.26  
 1st Qu.:0.1225   1st Qu.:0.1225   1st Qu.: 2.353   1st Qu.: 3.38  
 Median :0.2500   Median :0.2900   Median : 4.290   Median : 5.42  
 Mean   :0.6812   Mean   :0.3762   Mean   : 6.648   Mean   :11.99  
 3rd Qu.:0.9975   3rd Qu.:0.5275   3rd Qu.: 8.312   3rd Qu.:11.22  
 Max.   :3.0100   Max.   :1.4000   Max.   :35.890   Max.   :78.36  
       Pr               Nd               Sm               Eu        
 Min.   : 0.160   Min.   : 0.700   Min.   : 0.190   Min.   :0.0500  
 1st Qu.: 0.440   1st Qu.: 1.788   1st Qu.: 0.385   1st Qu.:0.1100  
 Median : 0.805   Median : 3.115   Median : 0.600   Median :0.1550  
 Mean   : 1.575   Mean   : 6.351   Mean   : 1.352   Mean   :0.3615  
 3rd Qu.: 1.490   3rd Qu.: 5.838   3rd Qu.: 1.183   3rd Qu.:0.2650  
 Max.   :11.100   Max.   :45.660   Max.   :10.160   Max.   :3.0400  
       Gd              Tb               Dy               Ho        
 Min.   :0.210   Min.   :0.0400   Min.   :0.1700   Min.   :0.0400  
 1st Qu.:0.445   1st Qu.:0.0625   1st Qu.:0.3375   1st Qu.:0.0825  
 Median :0.665   Median :0.1000   Median :0.4950   Median :0.1150  
 Mean   :1.368   Mean   :0.2019   Mean   :1.0519   Mean   :0.2185  
 3rd Qu.:1.258   3rd Qu.:0.1875   3rd Qu.:1.0175   3rd Qu.:0.2425  
 Max.   :9.680   Max.   :1.4300   Max.   :7.4800   Max.   :1.3800  
       Er               Tm         
 Min.   :0.1100   Min.   :0.02000  
 1st Qu.:0.2225   1st Qu.:0.03000  
 Median :0.3050   Median :0.05000  
 Mean   :0.5558   Mean   :0.08192  
 3rd Qu.:0.6525   3rd Qu.:0.09500  
 Max.   :3.3400   Max.   :0.46000  
```

---
# Inspecionando os dados

```r
str(dados.ex)
```

```
tibble [26 x 29] (S3: tbl_df/tbl/data.frame)
 $ Sample                   : chr [1:26] "SUC I-16B" "SUC I-15" "SUC I -13C" "SUC I -13B" ...
 $ Rock                     : chr [1:26] "Black shale" "Black shale" "Limestone" "Limestone" ...
 $ Distance from contact (m): chr [1:26] "2.3–2.7" "2.3–2.7" "2.1" "2.0499999999999998" ...
 $ Co                       : num [1:26] 19.16 7.23 6.65 6.64 8.5 ...
 $ Ni                       : num [1:26] 6.47 9.57 10.83 10.59 10.33 ...
 $ Cr                       : num [1:26] 16.1 17.1 16.3 15.7 18.1 ...
 $ V                        : num [1:26] 23.2 26.2 23.1 22.9 28 ...
 $ Sr                       : num [1:26] 33.5 411.6 603.6 575.6 598.6 ...
 $ Rb                       : num [1:26] 1.1 1.81 0.17 0.18 1.89 ...
 $ Ba                       : num [1:26] 49.8 25 101.2 72.5 138.7 ...
 $ Pb                       : num [1:26] 2.73 2.8 2.46 2.04 2.48 7.13 1.72 1.53 1.69 4.56 ...
 $ Zr                       : num [1:26] 9.47 17.15 16.56 14.33 27 ...
 $ Yb                       : num [1:26] 0.14 0.49 0.32 0.27 0.79 0.84 0.24 0.13 0.38 0.3 ...
 $ Nb                       : num [1:26] 0.81 2.34 1.1 0.99 2.2 5.01 0.84 0.65 2.72 1.66 ...
 $ Hf                       : num [1:26] 0.28 0.48 0.47 0.42 0.73 1.36 0.32 0.27 0.66 0.47 ...
 $ Th                       : num [1:26] 0.08 0.29 0.17 0.21 0.45 2.26 0.16 0.05 0.91 0.46 ...
 $ U                        : num [1:26] 0.04 0.25 0.14 0.1 0.33 0.8 0.11 0.02 0.39 0.34 ...
 $ La                       : num [1:26] 0.66 8.49 5.98 4.09 9.56 11.3 4.49 0.54 5.16 3.07 ...
 $ Ce                       : num [1:26] 1.42 11.1 7.24 4.83 11.26 ...
 $ Pr                       : num [1:26] 0.19 1.4 0.85 0.56 1.33 2.62 0.53 0.16 1.36 0.76 ...
 $ Nd                       : num [1:26] 0.81 5.5 3.2 2.17 5.08 ...
 $ Sm                       : num [1:26] 0.21 1.13 0.58 0.42 0.99 2 0.38 0.19 1.05 0.62 ...
 $ Eu                       : num [1:26] 0.06 0.27 0.16 0.12 0.25 0.4 0.11 0.05 0.2 0.15 ...
 $ Gd                       : num [1:26] 0.23 1.3 0.65 0.47 1.12 2.05 0.44 0.21 0.96 0.65 ...
 $ Tb                       : num [1:26] 0.04 0.19 0.09 0.07 0.18 0.29 0.06 0.04 0.14 0.1 ...
 $ Dy                       : num [1:26] 0.18 1.01 0.49 0.38 1.02 1.55 0.33 0.17 0.76 0.5 ...
 $ Ho                       : num [1:26] 0.05 0.22 0.12 0.09 0.25 0.33 0.08 0.04 0.15 0.11 ...
 $ Er                       : num [1:26] 0.12 0.57 0.32 0.26 0.73 0.86 0.23 0.11 0.39 0.29 ...
 $ Tm                       : num [1:26] 0.02 0.08 0.05 0.04 0.12 0.13 0.04 0.02 0.06 0.05 ...
```

--
# Inspecionando os dados

```r
head(dados.ex)
```

```
# A tibble: 6 x 29
  Sample  Rock  `Distance from ~    Co    Ni    Cr     V    Sr    Rb    Ba    Pb
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 SUC I-~ Blac~ 2.3–2.7          19.2   6.47  16.1  23.2  33.5  1.1   49.8  2.73
2 SUC I-~ Blac~ 2.3–2.7           7.23  9.57  17.2  26.2 412.   1.81  25.0  2.8 
3 SUC I ~ Lime~ 2.1               6.65 10.8   16.3  23.2 604.   0.17 101.   2.46
4 SUC I ~ Lime~ 2.0499999999999~  6.64 10.6   15.7  22.9 576.   0.18  72.6  2.04
5 SUC I ~ Lime~ 2                 8.5  10.3   18.1  28.0 599.   1.89 139.   2.48
6 SUC I-~ Blac~ 0.6–1.5          10.7  12.5   24.0  37.1  77.6  8.48  43.2  7.13
# ... with 18 more variables: Zr &lt;dbl&gt;, Yb &lt;dbl&gt;, Nb &lt;dbl&gt;, Hf &lt;dbl&gt;, Th &lt;dbl&gt;,
#   U &lt;dbl&gt;, La &lt;dbl&gt;, Ce &lt;dbl&gt;, Pr &lt;dbl&gt;, Nd &lt;dbl&gt;, Sm &lt;dbl&gt;, Eu &lt;dbl&gt;,
#   Gd &lt;dbl&gt;, Tb &lt;dbl&gt;, Dy &lt;dbl&gt;, Ho &lt;dbl&gt;, Er &lt;dbl&gt;, Tm &lt;dbl&gt;
```

---
# Inspecionando os dados

```r
names(dados.ex)
```

```
 [1] "Sample"                    "Rock"                     
 [3] "Distance from contact (m)" "Co"                       
 [5] "Ni"                        "Cr"                       
 [7] "V"                         "Sr"                       
 [9] "Rb"                        "Ba"                       
[11] "Pb"                        "Zr"                       
[13] "Yb"                        "Nb"                       
[15] "Hf"                        "Th"                       
[17] "U"                         "La"                       
[19] "Ce"                        "Pr"                       
[21] "Nd"                        "Sm"                       
[23] "Eu"                        "Gd"                       
[25] "Tb"                        "Dy"                       
[27] "Ho"                        "Er"                       
[29] "Tm"                       
```

---
# Exercício prático 1

- Explorar banco de dados volcano  
-- Importar  
-- Inspecionar colunas  
-- Inspecionar tipos de variáveis  

---

```r
volcano &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-12/volcano.csv')
volcano %&gt;% write.csv("volcano.csv")
```

---
# Dados

- "Tidy Tuesday live screencast: Analyzing volcano eruptions in R" by David Robinson

&lt;https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-05-12/readme.md&gt;


```r
volcano &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-12/volcano.csv')
eruptions &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-12/eruptions.csv')
events &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-12/events.csv')
tree_rings &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-12/tree_rings.csv')
sulfur &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-12/sulfur.csv')
```

---
# dplyr()

- Pacote para a manipulação de dados  
- Flexibilidade para transformar dados  


```r
library(dplyr)
```

&lt;img src="https://didatica.tech/wp-content/uploads/2019/10/dplyr.png" width="40%" style="display: block; margin: auto;" /&gt;

---
# select()


```r
volcano %&gt;% 
  select(volcano_name, country, latitude:elevation) %&gt;% 
  head()
```

```
# A tibble: 6 x 5
  volcano_name    country       latitude longitude elevation
  &lt;chr&gt;           &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 Abu             Japan             34.5     132.        641
2 Acamarachi      Chile            -23.3     -67.6      6023
3 Acatenango      Guatemala         14.5     -90.9      3976
4 Acigol-Nevsehir Turkey            38.5      34.6      1683
5 Adams           United States     46.2    -121.       3742
6 Adatarayama     Japan             37.6     140.       1728
```

---
# select()


```r
volcano %&gt;% 
  select(-tectonic_settings) %&gt;% 
  head()
```

```
# A tibble: 6 x 25
  volcano_number volcano_name  primary_volcano~ last_eruption_y~ country region 
           &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;   &lt;chr&gt;  
1         283001 Abu           Shield(s)        -6850            Japan   Japan,~
2         355096 Acamarachi    Stratovolcano    Unknown          Chile   South ~
3         342080 Acatenango    Stratovolcano(e~ 1972             Guatem~ México~
4         213004 Acigol-Nevse~ Caldera          -2080            Turkey  Medite~
5         321040 Adams         Stratovolcano    950              United~ Canada~
6         283170 Adatarayama   Stratovolcano(e~ 1996             Japan   Japan,~
# ... with 19 more variables: subregion &lt;chr&gt;, latitude &lt;dbl&gt;, longitude &lt;dbl&gt;,
#   elevation &lt;dbl&gt;, evidence_category &lt;chr&gt;, major_rock_1 &lt;chr&gt;,
#   major_rock_2 &lt;chr&gt;, major_rock_3 &lt;chr&gt;, major_rock_4 &lt;chr&gt;,
#   major_rock_5 &lt;chr&gt;, minor_rock_1 &lt;chr&gt;, minor_rock_2 &lt;chr&gt;,
#   minor_rock_3 &lt;chr&gt;, minor_rock_4 &lt;chr&gt;, minor_rock_5 &lt;chr&gt;,
#   population_within_5_km &lt;dbl&gt;, population_within_10_km &lt;dbl&gt;,
#   population_within_30_km &lt;dbl&gt;, population_within_100_km &lt;dbl&gt;
```

---
# funções que auxiliam na seleção das variáveis:

- **stars_with()**: colunas que começam com um prefixo
- **ends_with()**: colunas que terminam com um sufixo
- **contains()**: colunas que contêm uma string
- **last_col()**: última coluna


```r
volcano %&gt;% 
  select(starts_with("population")) %&gt;% 
  head()
```

```
# A tibble: 6 x 4
  population_within_~ population_within_~ population_within~ population_within_~
                &lt;dbl&gt;               &lt;dbl&gt;              &lt;dbl&gt;               &lt;dbl&gt;
1                3597                9594             117805             4071152
2                   0                   7                294                9092
3                4329               60730            1042836             7634778
4              127863              127863             218469             2253483
5                   0                  70               4019              393303
6                 428                3936             717078             5024654
```

---
# filter()


```r
volcano %&gt;% 
  select(volcano_name, country, latitude:elevation) %&gt;% 
  filter(country == "Antarctica") %&gt;% 
  head()
```

```
# A tibble: 6 x 5
  volcano_name     country    latitude longitude elevation
  &lt;chr&gt;            &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 Andrus           Antarctica    -75.8    -132.       2978
2 Berlin           Antarctica    -76.0    -136        3478
3 Buckle Island    Antarctica    -66.8     163.       1239
4 Deception Island Antarctica    -63.0     -60.7       602
5 Erebus           Antarctica    -77.5     167.       3794
6 Hudson Mountains Antarctica    -74.3     -99.4       749
```

---
# filter()


```r
volcano %&gt;% 
  select(volcano_name, country, latitude:elevation) %&gt;% 
  filter(!country == "Antarctica") %&gt;% 
  head()
```

```
# A tibble: 6 x 5
  volcano_name    country       latitude longitude elevation
  &lt;chr&gt;           &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 Abu             Japan             34.5     132.        641
2 Acamarachi      Chile            -23.3     -67.6      6023
3 Acatenango      Guatemala         14.5     -90.9      3976
4 Acigol-Nevsehir Turkey            38.5      34.6      1683
5 Adams           United States     46.2    -121.       3742
6 Adatarayama     Japan             37.6     140.       1728
```

---
# filter()


```r
volcano %&gt;% 
  select(volcano_name, country, latitude:elevation) %&gt;% 
  filter(country == "Antarctica" | latitude &gt; 10) %&gt;% 
  head()
```

```
# A tibble: 6 x 5
  volcano_name    country       latitude longitude elevation
  &lt;chr&gt;           &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 Abu             Japan             34.5     132.        641
2 Acatenango      Guatemala         14.5     -90.9      3976
3 Acigol-Nevsehir Turkey            38.5      34.6      1683
4 Adams           United States     46.2    -121.       3742
5 Adatarayama     Japan             37.6     140.       1728
6 Adwa            Ethiopia          10.1      40.8      1733
```

---
# filter()


```r
volcano %&gt;% 
  select(volcano_name, country, latitude:elevation) %&gt;% 
  filter(country %in% c("Antarctica", "Japan")) %&gt;% 
  head()
```

```
# A tibble: 6 x 5
  volcano_name     country latitude longitude elevation
  &lt;chr&gt;            &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 Abu              Japan       34.5      132.       641
2 Adatarayama      Japan       37.6      140.      1728
3 Aira             Japan       31.6      131.      1117
4 Akagisan         Japan       36.6      139.      1828
5 Akan             Japan       43.4      144.      1499
6 Akita-Komagatake Japan       39.8      141.      1637
```

---
# filter()


```r
volcano %&gt;% 
  select(volcano_name, country, latitude:elevation) %&gt;% 
  filter(country == "Japan" &amp; latitude &gt; 1) %&gt;% 
  head()
```

```
# A tibble: 6 x 5
  volcano_name     country latitude longitude elevation
  &lt;chr&gt;            &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 Abu              Japan       34.5      132.       641
2 Adatarayama      Japan       37.6      140.      1728
3 Aira             Japan       31.6      131.      1117
4 Akagisan         Japan       36.6      139.      1828
5 Akan             Japan       43.4      144.      1499
6 Akita-Komagatake Japan       39.8      141.      1637
```

---
# mutate()

- Modifica e cria colunas


```r
volcano %&gt;% 
  select(volcano_name, country, last_eruption_year) %&gt;% 
  filter(!country == "Antarctica") %&gt;% 
  mutate(last_eruption_year = as.numeric(last_eruption_year),
         years_ago = 2020 - last_eruption_year) %&gt;% 
  head()
```

```
# A tibble: 6 x 4
  volcano_name    country       last_eruption_year years_ago
  &lt;chr&gt;           &lt;chr&gt;                      &lt;dbl&gt;     &lt;dbl&gt;
1 Abu             Japan                      -6850      8870
2 Acamarachi      Chile                         NA        NA
3 Acatenango      Guatemala                   1972        48
4 Acigol-Nevsehir Turkey                     -2080      4100
5 Adams           United States                950      1070
6 Adatarayama     Japan                       1996        24
```

---
# group_by()

- sozinho não faz nenhuma alteração notável na base
- quando usado junto com funções como mutate() ou summarise() muda o escopo da função:
  - executa o código separadamente para cada grupo
  - trata de cada grupo como se fossem banco de dados distintos

---
# summarise()


```r
volcano %&gt;% 
  select(volcano_name, country, latitude:elevation, last_eruption_year) %&gt;% 
  filter(country %in% c("United States", "Mexico", "Canada")) %&gt;% 
  group_by(country) %&gt;% 
  summarise(n = n(),
            media_lat = mean(elevation),
            sd_lat = sd(elevation),
            min = min(elevation, na.rm = TRUE),
            max = max(elevation, na.rm = TRUE)) %&gt;% 
  ungroup()
```

```
# A tibble: 3 x 6
  country           n media_lat sd_lat   min   max
  &lt;chr&gt;         &lt;int&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Canada           18     1954.  1182. -2050  3160
2 Mexico           28     2676.  1685.    95  5564
3 United States    99     1760.  1187. -1535  4392
```

---
# count()

- Exemplo: Quantos vulcões existem nos Estados Unidos e no México?


```r
volcano %&gt;% 
  select(volcano_name, country) %&gt;% 
  filter(country %in% c("United States", "Mexico")) %&gt;% 
  group_by(country) %&gt;% 
  count(sort = TRUE)
```

```
# A tibble: 2 x 2
# Groups:   country [2]
  country           n
  &lt;chr&gt;         &lt;int&gt;
1 United States    99
2 Mexico           28
```

---
# arrange()


```r
volcano %&gt;% 
  select(volcano_name, country, latitude:elevation) %&gt;% 
  arrange(volcano_name) %&gt;% 
  head()
```

```
# A tibble: 6 x 5
  volcano_name    country       latitude longitude elevation
  &lt;chr&gt;           &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 Abu             Japan             34.5     132.        641
2 Acamarachi      Chile            -23.3     -67.6      6023
3 Acatenango      Guatemala         14.5     -90.9      3976
4 Acigol-Nevsehir Turkey            38.5      34.6      1683
5 Adams           United States     46.2    -121.       3742
6 Adatarayama     Japan             37.6     140.       1728
```

---
# if_else()

- retorna um valor dependendo de um teste lógico


```r
volcano %&gt;% 
  mutate(new_variable = if_else(last_eruption_year &lt;= 2000, "2000-", "2000+")) %&gt;% 
  count(new_variable)
```

```
# A tibble: 2 x 2
  new_variable     n
  &lt;chr&gt;        &lt;int&gt;
1 2000-          456
2 2000+          502
```

---
# case_when()

- generalização do if_else()


```r
volcano %&gt;% 
  mutate(new_variable = case_when(last_eruption_year &lt;= 2000 ~ "até 2000",
                                  last_eruption_year &lt;= 2010 ~ "até 2010",
                                  last_eruption_year &lt;= 2020 ~ "até 2020",
                                  TRUE ~ "outros")) %&gt;% 
  count(new_variable)
```

```
# A tibble: 4 x 2
  new_variable     n
  &lt;chr&gt;        &lt;int&gt;
1 até 2000       456
2 até 2010        42
3 até 2020       119
4 outros         341
```

- O TRUE significa que caso as observações não entrem nas condições anteriores a função retorna o valor do lado direito

---
# n() e n_distinct()

- n(): retorna o tamanho do grupo
- n_distinct(): retorna o número de tamanhos distintos


```r
volcano %&gt;% 
  select(volcano_name, country, latitude:elevation, last_eruption_year) %&gt;% 
  mutate(var = n(),
         var1 = n_distinct(last_eruption_year)) %&gt;% 
  head()
```

```
# A tibble: 6 x 8
  volcano_name country latitude longitude elevation last_eruption_y~   var  var1
  &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;            &lt;int&gt; &lt;int&gt;
1 Abu          Japan       34.5     132.        641 -6850              958   342
2 Acamarachi   Chile      -23.3     -67.6      6023 Unknown            958   342
3 Acatenango   Guatem~     14.5     -90.9      3976 1972               958   342
4 Acigol-Nevs~ Turkey      38.5      34.6      1683 -2080              958   342
5 Adams        United~     46.2    -121.       3742 950                958   342
6 Adatarayama  Japan       37.6     140.       1728 1996               958   342
```

---
# Perguntas:

- 1) Se quisermos gerar médias para uma variávek categórica X, qual a primeira e a segunda função que utilizaremos?

- 2) Se quisermos excluir linhas (criar subsets), qual a função que utilizaremos?

- 3) Se quisermos excluir colunas, qual função utilizaremos?

---
# Exercícios práticos 2

### Resolvendo problemas..
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
- 1) Em qual país existem mais vulcões?  
- 2) Nesse país, qual o tipo de vulcão mais comum?  
- 3) Na América do Sul, quantos e quais vulcões entraram em erupção em 2020?  
- 4) Quais os países nos quais os vulcões apresentam maior risco para a população local (até 5 km)? Filtre países em que existam mais de 2 vulcões.
=======
- Em qual país existem mais vulcões?  
- Nesse país, qual o tipo de vulcão mais comum?  
- Na América do Sul, quantos e quais vulcões entraram em erupção em 2020?  
- Quais os países nos quais os vulcões apresentam maior risco para a população local (até 5 km)?  
&gt;&gt;&gt;&gt;&gt;&gt;&gt; bbc25d19e028bc86eb29838526a6f5380aa22bed

### Funções
-- select()  
-- filter()  
-- mutate()  
-- group_by()  
-- count()  
-- summarise()  
-- arrange()  

---
# Respostas: 

- Em qual país existem mais vulcões?


```r
volcano %&gt;% 
  group_by(country) %&gt;% 
  count(country, sort = TRUE)
```

```
# A tibble: 89 x 2
# Groups:   country [89]
   country              n
   &lt;chr&gt;            &lt;int&gt;
 1 United States       99
 2 Indonesia           95
 3 Japan               92
 4 Russia              79
 5 Chile               43
 6 Iceland             28
 7 Mexico              28
 8 Papua New Guinea    28
 9 Philippines         27
10 Ecuador             26
# ... with 79 more rows
```

---
- Nesse país, qual o tipo de vulcão mais comum?


```r
volcano %&gt;% 
  filter(country == "United States") %&gt;% 
  count(primary_volcano_type, sort = TRUE)
```

```
# A tibble: 15 x 2
   primary_volcano_type     n
   &lt;chr&gt;                &lt;int&gt;
 1 Stratovolcano           32
 2 Shield                  15
 3 Volcanic field          13
 4 Stratovolcano(es)        8
 5 Submarine                6
 6 Pyroclastic cone(s)      5
 7 Shield(s)                5
 8 Lava dome(s)             4
 9 Caldera                  3
10 Maar(s)                  3
11 Caldera(s)               1
12 Complex                  1
13 Pyroclastic cone         1
14 Stratovolcano?           1
15 Tuff cone(s)             1
```

---
- Na América do Sul, quantos e quais vulcões entraram em erupção em 2020?


```r
volcano %&gt;% 
  select(region, volcano_name, last_eruption_year) %&gt;% 
  filter(region == "South America",
         last_eruption_year == "2020") %&gt;% 
  count(volcano_name, last_eruption_year)
```

```
# A tibble: 6 x 3
  volcano_name        last_eruption_year     n
  &lt;chr&gt;               &lt;chr&gt;              &lt;int&gt;
1 Chillan, Nevados de 2020                   1
2 Reventador          2020                   1
3 Ruiz, Nevado del    2020                   1
4 Sabancaya           2020                   1
5 Sangay              2020                   1
6 Villarrica          2020                   1
```

---
- Quais os países nos quais os vulcões apresentam maior risco para a população local (até 5 km)?
  -- Obs.: pegue (filtre) países em que existam mais de 2 vulcões.


```r
volcano %&gt;% 
  select(country, population_within_5_km) %&gt;% 
  group_by(country) %&gt;% 
  summarise(n = n(),
            media_pop = mean(population_within_5_km),
            sd_pop = sd(population_within_5_km),
            max_pop = max(population_within_5_km)) %&gt;% 
  filter(n &gt; 2) %&gt;% #mais de 2 vulcões no país
  arrange(desc(media_pop))
```

```
# A tibble: 52 x 5
   country          n media_pop   sd_pop max_pop
   &lt;chr&gt;        &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 Armenia          3   432210   721521. 1265153
 2 Vietnam          3   376222   537303.  991688
 3 Italy           12   292554.  662546. 2234109
 4 Uganda           3   288883   140125.  446218
 5 Mexico          28   269105. 1091616. 5783287
 6 China            8   255031.  598402. 1731229
 7 El Salvador     14   231179.  553330. 2049583
 8 Saudi Arabia     8   170776.  353415. 1010115
 9 Yemen            9   153611.  262493.  791276
10 Cameroon         3   122298.  117445.  234623
# ... with 42 more rows
```


---
# tidyr()


```r
library(tidyr)
```

&lt;img src="https://www.dadosaleatorios.com.br/post/introducao-ao-tidyr/featured.png" width="30%" style="display: block; margin: auto;" /&gt;

- O pacote possui funções para deixar os dados em formato *tidy*

- Dados **tidy** estão organizados de forma que:
  - cada linha é uma observação
  - cada coluna é uma variável 
  - cada célula representa um único valor

---
# pivot_longer()

- alonga os dados


```r
volcano_long &lt;- volcano %&gt;% 
  select(volcano_name, latitude, longitude) %&gt;% 
  pivot_longer(cols = c(latitude, longitude),
               names_to = "variable",
               values_to = "value") %&gt;% 
  head()

volcano_long
```

```
# A tibble: 6 x 3
  volcano_name variable  value
  &lt;chr&gt;        &lt;chr&gt;     &lt;dbl&gt;
1 Abu          latitude   34.5
2 Abu          longitude 132. 
3 Acamarachi   latitude  -23.3
4 Acamarachi   longitude -67.6
5 Acatenango   latitude   14.5
6 Acatenango   longitude -90.9
```


---
# pivot_wider()

- alarga os dados


```r
volcano %&gt;% 
  select(volcano_name, latitude, longitude, last_eruption_year) %&gt;% 
  mutate(last_eruption_year = case_when(last_eruption_year &lt;= 2000 ~ "before_2000",
                                        last_eruption_year &gt; 2000 ~ "after_2000")) %&gt;% 
  pivot_wider(names_from = last_eruption_year,
              values_from = latitude) %&gt;% 
  head()
```

```
# A tibble: 6 x 4
  volcano_name    longitude before_2000 after_2000
  &lt;chr&gt;               &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;
1 Abu                 132.         34.5       NA  
2 Acamarachi          -67.6        NA        -23.3
3 Acatenango          -90.9        14.5       NA  
4 Acigol-Nevsehir      34.6        38.5       NA  
5 Adams              -121.         NA         46.2
6 Adatarayama         140.         37.6       NA  
```


---
# separate()

- separa uma coluna em várias usando um separador


```r
volcano %&gt;% 
  select(volcano_name, tectonic_settings) %&gt;% 
  separate(tectonic_settings,
           into = c("zone", "crust"),
           sep = " / ") %&gt;% 
  head()
```

```
# A tibble: 6 x 3
  volcano_name    zone            crust                     
  &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;                     
1 Abu             Subduction zone Continental crust (&gt;25 km)
2 Acamarachi      Subduction zone Continental crust (&gt;25 km)
3 Acatenango      Subduction zone Continental crust (&gt;25 km)
4 Acigol-Nevsehir Intraplate      Continental crust (&gt;25 km)
5 Adams           Subduction zone Continental crust (&gt;25 km)
6 Adatarayama     Subduction zone Continental crust (&gt;25 km)
```


---
# unite()

- junta várias colunas em uma usando um separador


```r
volcano %&gt;% 
  select(volcano_name, volcano_number) %&gt;% 
  unite(col = volcano_name, 
        volcano_number,
        volcano_name,
        sep = "_") %&gt;% 
  head()
```

```
# A tibble: 6 x 1
  volcano_name          
  &lt;chr&gt;                 
1 283001_Abu            
2 355096_Acamarachi     
3 342080_Acatenango     
4 213004_Acigol-Nevsehir
5 321040_Adams          
6 283170_Adatarayama    
```


---
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
# Exercício prático 3
=======
# Exercícios 3
&gt;&gt;&gt;&gt;&gt;&gt;&gt; bbc25d19e028bc86eb29838526a6f5380aa22bed

- 

---
# Respostas


```r
volcano %&gt;% 
  select(country, primary_volcano_type, major_rock_1) %&gt;% 
  mutate(primary_volcano_type = str_to_lower(primary_volcano_type),
         primary_volcano_type = str_replace(primary_volcano_type, " ", "_"),
         primary_volcano_type = str_replace(primary_volcano_type, "\\s*\\([^\\)]+\\)", ""),
         primary_volcano_type = str_replace(primary_volcano_type, "[:punct:]", "")) %&gt;% 
  count(country, primary_volcano_type, sort = TRUE) %&gt;% 
  pivot_wider(names_from = "primary_volcano_type",
              values_from = "n")
```

```
# A tibble: 89 x 17
   country    stratovolcano shield complex volcanicfield caldera pyroclasticcone
   &lt;chr&gt;              &lt;int&gt;  &lt;int&gt;   &lt;int&gt;         &lt;int&gt;   &lt;int&gt;           &lt;int&gt;
 1 Indonesia             65     NA      14            NA      12               2
 2 Japan                 51      8       7            NA      11               1
 3 United St~            41     20       1            13       4               6
 4 Russia                33     20       3             4       7               7
 5 Chile                 29      1       1            NA       3               6
 6 Philippin~            19     NA       3            NA       2              NA
 7 Iceland               12      1      NA            NA       2               1
 8 Ecuador               11      9      NA            NA       3               1
 9 Guatemala             11     NA       1             3      NA               1
10 El Salvad~            10     NA      NA             1       2               1
# ... with 79 more rows, and 10 more variables: lavadome &lt;int&gt;,
#   submarine &lt;int&gt;, craterrows &lt;int&gt;, subglacial &lt;int&gt;, fissurevent &lt;int&gt;,
#   tuffcone &lt;int&gt;, pyroclasticshield &lt;int&gt;, compound &lt;int&gt;, maar &lt;int&gt;,
#   lavacone &lt;int&gt;
```

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
