---
title: "Aula 5"
author: "Gabriel Bertolini"
date: "05/07/2021"
subtitle: "Reproduzindo Geociência"
output: html_document
editor_options: 
  chunk_output_type: console
---
# (geo-) Ciência de dados

## Estudo de caso 1

-- O estudo pioneiro de Elkins, L. T. & Grove, T. L (1990) "Ternary Feldspar Experiments and Thermodynamic Models American Mineralogist"
-- Elkins, L. T. & Grove, T. L. Ternary Feldspar Experiments and Thermodynamic Models American Mineralogist, Mineral Soc America, 1990, 75, 544-559

- 1) Explorar banco de dados "Feldspar"
- 2) Existe relação entre os teores dos componentes Ab, An e Or em feldspatos com:

-- a) Tipos de feldspato?
-- b) Temperatura?
-- c) Pressão?

- 3) Modelar isotermas e isóbaras



## Estudo de caso 2

- Estudo de caso de petrofísica e petrologia de Bertolini et al. (2021)- busca entender a relação entre diagênese e petrofísica na interface lava-sedimento, com exemplo ns interação entre a Fm. Botucatu em contato e Fm. Serra Geral
- Estudo de caso em análise de reservatório

- 1) Explorar banco de dados "lvsd"
- 2 Qual relação entre as velocidades das ondas P- e S- nos arenitos? (Modele)
- 3) A porosidade controla a velocidade da onda sísmica? - (Modele)
- 4) A estratigrafia controla a a diagênese?
- 5) qual a relação entre a distancia até a lava e porosidade? e ondas sismicas?
- 6) qual relação da diagênese e distância até a lava?
- 7) e da provêniencia?


## Respostas- Estudo de caso 1

```{r}
library(tidyverse)
library(tidypaleo)

```

```{r}
#1 - Explorar 
Feldspar
data(Feldspar)

view (Feldspar)  # Abre janela estilo excel ou então, selecionar objeto-banco de dados e apertar F2

Feldspar %>% str()

Feldspar %>% 
  group_by(Feldspar) %>% 
  summarise(mean_Ab=mean(Ab),
            mean_An=mean(An),
            mean_Or=mean(Or))
  

#2a - Tipos de Feldspato

ggtern(data=Feldspar,aes(x=An,y=Ab,z=Or)) + 
    geom_point(aes(color=Feldspar))

#2b - Temperatura?

ggtern(data=Feldspar,aes(x=An,y=Ab,z=Or)) + 
    geom_point(aes(color=T.C))+
    facet_wrap(~Feldspar)

#2c - Pressão?
ggtern(data=Feldspar,aes(x=An,y=Ab,z=Or)) + 
    geom_point(aes(color=P.Gpa))+
    facet_wrap(~Feldspar)

#3 - Modelo

ggtern(data=Feldspar,aes(x=An,y=Ab,z=Or)) + 
    ggtern::geom_crosshair_tern(aes(color=T.C,
                   shape=Feldspar,
                   size=P.Gpa))



```

# Estudo de caso 2
```{r}
library(readxl)
setwd("D:/Documentos Drive/Academicos/Aulas/ProgramacaoFuncional_Geologia")
lv<-read_csv("petrophysics_bertolini_2020.csv") %>% unite(sample,c("Sample", "a"),sep = "-")
sd_1<-read_excel("petrography_bertolini_2020.xlsx",sheet=1)

lvsd<-left_join(lv,sd_1,by="sample")
  
#1 Explorar banco de dados "lvsd"

lvsd

lvsd %>% str()
  
lvsd %>% group_by(well) %>% 
  summarise(across(starts_with("Por"), ~ mean(.x, na.rm = TRUE)))
  
lvsd %>% group_by(well) %>% 
  summarise(across(starts_with("Comp"), ~ mean(.x, na.rm = TRUE)))  
  

#2 Qual relação entre as velocidades das ondas P- e S- nos arenitos? (Modele)


lvsd %>% 
  drop_na(s_wave) %>% 
  ggplot(aes(x=p_wave,y=s_wave))+
  geom_point()+
  geom_smooth(method = "lm")+
  labs(title="Velocidade sísmica em arenitos da Fm. Botucatu")+
  xlab("Onda P")+
  ylab("Onda S")

#3 A porosidade controla a velocidade da onda sísmica? - (Modele)

lvsd %>% 
  drop_na(s_wave) %>%
  pivot_longer(cols = c(p_wave:s_wave),names_to = "var",values_to = "seismic_velocity") %>% 
  ggplot(aes(x=porosity,y=seismic_velocity))+
  geom_point()+
  geom_smooth(method = "lm")+
  facet_wrap(~var)+
  labs(title="Velocidade sísmica e porosidade arenitos da Fm. Botucatu")


#4 Qual a relação entre petrofisica e estratigrafia (well TG-227)?

lvsd %>%
  filter(well=="TG-227") %>% 
  pivot_longer(cols = c(p_wave:s_wave,porosity, density),names_to = "var",values_to = "value") %>%
  mutate(var=factor(var,levels = c("porosity","density","p_wave","s_wave"))) %>% 
  ggplot(aes(x = value, y = depth)) +
  geom_lineh() +
  geom_point() +
  scale_y_reverse() +
  facet_geochem_gridh(vars(var), scales = "free") +
  geom_hline(yintercept = c(283.45,298.10), col = "red", lty = 2, alpha = 0.7)+
  labs(x = NULL, y = "Depth (m)", title = "Cretaceous Paraná Basin")+
  theme_classic()
  

#5 qual a relação entre a distancia até a lava e porosidade? e ondas sismicas?

lvsd %>% 
  mutate(dis_1=)


#6 qual relação da diagênese e distância até a lava?




#7  e da provêniencia?
```

